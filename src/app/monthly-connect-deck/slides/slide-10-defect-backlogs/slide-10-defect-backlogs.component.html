<div class="slide">
  <header>
    <div class="title-group">
      <div class="logo-placeholder">
        <svg viewBox="0 0 24 24" fill="white" width="22" height="22">
          <path d="M20,8H17.19a4,4,0,0,0-3.19-2.73L15.36,3.9a1,1,0,0,0-1.72-1L12.3,5.16l-1.33,0L9.64,1.86a1,1,0,0,0-1.72,1l1.36,1.37A4,4,0,0,0,6.81,7H4a1,1,0,0,0,0,2H6.1c0,.33,0,.66,0,1a5,5,0,0,0,1,3.06L5.34,14.82a1,1,0,1,0,1.42,1.41L8.52,14.5a4.93,4.93,0,0,0,3.48,1.5,4.93,4.93,0,0,0,3.48-1.5l1.76,1.73a1,1,0,1,0,1.42-1.41l-1.76-1.76A5,5,0,0,0,17.9,10c0-.34,0-.67,0-1H20a1,1,0,0,0,0-2ZM12,14a3,3,0,0,1-3-3V11a3,3,0,0,1,6,0v0A3,3,0,0,1,12,14Z"/>
        </svg>
      </div>
      <div class="title-text">
        <h1>Defect Backlogs</h1>
        <p>Comprehensive Backlog Overview â€¢ DQME Portal INT</p>
      </div>
    </div>
    <div class="cycle-focus">
      <label>Cycle Focus</label>
      <div class="date-display">
        <span>{{ reportMonth }} {{ reportYear }}</span>
        <div class="date-box">10</div>
      </div>
    </div>
  </header>

  <div class="main-layout">
    <div class="sidebar">
      <div class="stats-card resolution">
        <span class="card-label">Backlog Status</span>
        <div class="res-flex">
          <span class="res-count">{{ totalBacklog | number:'2.0-0' }}</span>
          <span class="res-percent" style="color: var(--accent-blue);">{{ (inProgressCount / (totalBacklog || 1)) | percent }}</span>
        </div>
        <p style="font-size: 11px; font-weight: 800; color: var(--text-muted); margin-bottom: 4px; letter-spacing: 0.05em;">IN PROGRESS / TOTAL BACKLOG</p>
        <div class="progress-bar-container">
          <div class="progress-bar" [style.width]="getProgressWidth()"></div>
        </div>
        <p style="font-size: 11px; text-align: right; color: var(--text-muted); margin-top: 4px; font-weight: 600;">{{ inProgressCount }} / {{ totalBacklog }}</p>
      </div>

      <div class="stats-card">
        <span class="card-label">Severity Breakdown</span>
        <ul class="severity-list">
          <li class="severity-item p2"><span>P2 Critical</span> <span>{{ p2Count }}</span></li>
          <li class="severity-item p3"><span>P3 High</span> <span>{{ p3Count }}</span></li>
          <li class="severity-item p4"><span>P4 Medium</span> <span>{{ p4Count }}</span></li>
        </ul>

        <div class="root-cause-section">
          <span class="card-label">State Distribution</span>
          <div class="rc-item">
            <div class="rc-label"><span>In Progress</span> <span>{{ inProgressCount }} Items</span></div>
            <div class="rc-bar"><div class="rc-fill" [style.width.%]="(inProgressCount / (totalBacklog || 1)) * 100" style="background: var(--accent-blue);"></div></div>
          </div>
          <div class="rc-item">
            <div class="rc-label"><span>New / To Do</span> <span>{{ newCount }} Items</span></div>
            <div class="rc-bar"><div class="rc-fill" [style.width.%]="(newCount / (totalBacklog || 1)) * 100" style="background: var(--accent-orange);"></div></div>
          </div>
        </div>
      </div>

      <div class="footer-logo">
        Cognizant x Caterpillar
      </div>
    </div>

    <div class="registry-container">
      <div class="registry-header">
        <h2>Backlog Registry</h2>
        <div style="display: flex; gap: 10px; align-items: center;">
          <span style="font-size: 11px; font-weight: 700; color: var(--text-muted);">ITEMS:</span>
          <div class="filter-pill">Active Backlog</div>
        </div>
      </div>

      <div class="table-scroll">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Pri.</th>
              <th>Description</th>
              <th>State</th>
              <th>Assigned To</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of backlogItems">
              <td class="id-cell">#{{ item.id }}</td>
              <td class="pri-cell">
                <span class="priority-dot" [style.background]="getPriColor(item.priority)"></span>
                P{{ item.priority }}
              </td>
              <td class="desc-cell">
                <div class="desc-title">{{ item.title }}</div>
                <div class="tag-row">
                  <span class="tag" *ngFor="let tag of getTags(item.tags || '')">{{ tag }}</span>
                </div>
              </td>
              <td class="state-cell">
                <span class="badge" [ngClass]="getStateBadgeClass(item.state)">{{ item.state }}</span>
              </td>
              <td class="assign-cell">
                <div class="user-info">
                  <div class="avatar">{{ getInitials(item.assignedTo || '') }}</div>
                  <div class="user-name">{{ getDisplayName(item.assignedTo || '') }}</div>
                </div>
              </td>
            </tr>
            <tr *ngIf="backlogItems.length === 0">
              <td colspan="5" style="text-align: center; padding: 40px; color: var(--text-muted);">
                No pending backlog items found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
